(this.webpackJsonpmongodb_realm_grid=this.webpackJsonpmongodb_realm_grid||[]).push([[0],{265:function(e,t,n){},271:function(e,t){},273:function(e,t){},282:function(e,t){},284:function(e,t){},311:function(e,t){},312:function(e,t){},317:function(e,t){},319:function(e,t){},326:function(e,t){},345:function(e,t){},475:function(e,t,n){"use strict";n.r(t);var r,a,c,o=n(2),s=n.n(o),i=n(102),u=n.n(i),l=(n(265),n(10)),d=n.n(l),f=n(22),p=n(20),b=n(18),g=n(60),j=n(12),h=s.a.createContext(),m=function(){var e=s.a.useContext(h);if(!e)throw new Error("You must call useRealmApp() inside of a <RealmAppProvider />");return e},O=function(e){var t=e.appId,n=e.children,r=s.a.useState(new g.a(t)),a=Object(b.a)(r,2),c=a[0],o=a[1];s.a.useEffect((function(){o(new g.a(t))}),[t]);var i=s.a.useState(c.currentUser),u=Object(b.a)(i,2),l=u[0],m=u[1];function O(){return(O=Object(p.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=g.b.jwt(t),e.next=3,c.logIn(n);case 3:m(c.currentUser);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(){return(v=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.logIn(g.b.google("".concat("https://mybankgridview-ahggo.mongodbstitch.com","/google_login")));case 2:m(c.currentUser);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){return(x=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.logIn(t);case 2:m(c.currentUser);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return(y=Object(p.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=c.currentUser)||void 0===t?void 0:t.logOut();case 2:m(c.currentUser);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var w=Object(f.a)(Object(f.a)({},c),{},{currentUser:l,logIn:function(e){return x.apply(this,arguments)},logInJwt:function(e){return O.apply(this,arguments)},logInGoogle:function(){return v.apply(this,arguments)},logOut:function(){return y.apply(this,arguments)}});return Object(j.jsx)(h.Provider,{value:w,children:n})},v=n(132),x=n(486),y=n(257),w=n(23),k=n(73),I=n(245),C=n(111),S=n(110),R=n(131),G=n(7),U=n(165),D=C.a.div(r||(r=Object(k.a)(["\n  height: 100vh;\n  justify-content: center;\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n  background: ",";\n"])),G.a.gray.light2),E=n(254),F=n.n(E);function M(){return Object(j.jsx)(F.a,{size:"15px",margin:"3px",color:G.a.gray.dark2})}var T=function(){var e=m(),t=s.a.useState(""),n=Object(b.a)(t,2),r=n[0],a=n[1],c=s.a.useState(""),o=Object(b.a)(c,2),i=o[0],u=o[1],l=s.a.useState({}),h=Object(b.a)(l,2),O=h[0],x=h[1],y=s.a.useState(!1),w=Object(b.a)(y,2),k=w[0],C=w[1],G=Object(v.b)(),E=G.instance,F=G.accounts,T=function(){var t=Object(p.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return C(!0),x((function(e){return Object(f.a)(Object(f.a)({},e),{},{password:null})})),t.prev=2,t.next=5,e.logIn(g.b.emailPassword(r,i));case 5:t.next=11;break;case 7:t.prev=7,t.t0=t.catch(2),N(t.t0,x),C(!1);case 11:case"end":return t.stop()}}),t,null,[[2,7]])})));return function(){return t.apply(this,arguments)}}(),P=function(){var t=Object(p.a)(d.a.mark((function t(){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,E.acquireTokenPopup({scopes:["".concat("ce0096fb-ed00-4e8f-bc85-0ddffffadf6e","/.default")],account:F[0]});case 3:return n=t.sent,t.next=6,JSON.stringify(n.accessToken).slice(1,-1);case 6:return n=t.sent,t.next=9,e.logInJwt(n);case 9:t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0),N(t.t0,x);case 15:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(){return t.apply(this,arguments)}}(),A=function(){var t=Object(p.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.logInGoogle();case 3:t.next=9;break;case 5:t.prev=5,t.t0=t.catch(0),console.log(t.t0),N(t.t0,x);case 9:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(){return t.apply(this,arguments)}}(),N=function(e,t){var n=function(e){var t,n=e.message.split(":"),r=n[n.length-1].trimStart();if(!r)return{status:"",message:""};var a=Object(I.a)(/(.+)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]\(status ([0-9][0-9][0-9])/,{message:1,status:2}),c=r.match(a),o=null!==(t=null===c||void 0===c?void 0:c.groups)&&void 0!==t?t:{},s=o.status,i=o.message;return{status:s,message:i}}(e),r=n.status,a=n.message||r;switch(console.log(a),a){case"invalid username":t((function(e){return Object(f.a)(Object(f.a)({},e),{},{email:"Invalid email address"})}));break;case"invalid username/password":case"invalid password":case"401":t((function(e){return Object(f.a)(Object(f.a)({},e),{},{password:"Incorrect password"})}))}};return Object(j.jsx)(D,{children:k?Object(j.jsx)(M,{}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(B,{children:Object(j.jsx)(q,{children:"Please identify"})}),Object(j.jsx)(B,{children:Object(j.jsx)(S.a,{type:"email",label:"Email",value:r,onChange:function(e){return a(e.target.value)},errorMessage:O.email,state:O.email?"error":"none"})}),Object(j.jsx)(B,{children:Object(j.jsx)(S.a,{type:"password",label:"Password",value:i,onChange:function(e){return u(e.target.value)},errorMessage:O.password,state:O.password?"error":"none"})}),Object(j.jsx)(B,{children:Object(j.jsx)(R.a,{variant:"primary",onClick:function(){return T()},children:"Login"})}),Object(j.jsx)(B,{children:Object(j.jsx)(U.MicrosoftLoginButton,{onClick:function(){return P()}})}),Object(j.jsx)(B,{children:Object(j.jsx)(U.GoogleLoginButton,{onClick:function(){return A()}})})]})})};var P,q=C.a.h1(a||(a=Object(k.a)(["\n  margin: 0;\n  font-size: 32px;\n"]))),B=C.a.div(c||(c=Object(k.a)(["\n  margin-bottom: 16px;\n"]))),A=function(){return Object(o.useEffect)((function(){Object(g.c)()})),Object(j.jsx)("h1",{children:"Signing in... Please Wait"})},N=n(255),L=n(92),z=(n(472),n(473),n(474),{columnTypes:{detail:{enableRowGroup:!1,enablePivot:!1},dimension:{enableRowGroup:!0,enablePivot:!0},fact:{aggFunc:"sum"}},defaultColDef:{sortable:!0,resizable:!0},rowSelection:"single",rowModelType:"serverSide",serverSideStoreType:"partial",cacheBlockSize:50,rowGroupPanelShow:"always",groupDisplayType:"multipleColumns",onSortChanged:function(e){e.api.refreshServerSideStore({purge:!0})},maxConcurrentDatasourceRequests:5,rowBuffer:100}),_=n(478),J=function(e){return function(t){return Object(j.jsx)(_.a,{children:function(n){return Object(j.jsx)(e,Object(f.a)({client:n},t))}})}},Y=n(489),W=n(167),K=n.p+"static/media/ag-grid-logo.d4a5e8e0.png",Q=n.p+"static/media/react-logo.f153eb9f.png",$=function(){return Object(j.jsxs)("div",{style:{margin:20},children:[Object(j.jsx)(W.a,{}),Object(j.jsx)("span",{style:{marginRight:20}}),Object(j.jsx)(W.b,{}),Object(j.jsx)("span",{style:{marginRight:20}}),Object(j.jsx)("img",{src:K,style:{height:"20px",paddingBottom:8}}),Object(j.jsx)("span",{style:{marginRight:20}}),Object(j.jsx)("img",{src:Q,height:"35px"})]})},V=function(e){return new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(e.value)},H=J((function(e){var t=e.client,n=m(),r=Object(o.useState)(null),a=Object(b.a)(r,2),c=a[0],s=a[1],i=Object(o.useState)(0),u=Object(b.a)(i,2),l=u[0],d=u[1],f=Object(o.useState)(""),p=Object(b.a)(f,2),g=p[0],h=p[1],O=Object(o.useState)(n.currentUser),v=Object(b.a)(O,1)[0],x=v.customData.role,y=Object(L.debounce)(h,500),w=[{field:"customer",colId:"customerId",valueGetter:"data.customerId",type:"detail",cellRenderer:"agGroupCellRenderer"},{field:"lastName",type:"detail"},{field:"firstName",type:"detail"},{field:"age",type:"user"===x?"detail":"dimension"},{field:"country",colId:"address.country",type:"user"===x?"detail":"dimension",valueGetter:"data.address.country"},{field:"segment",colId:"crmInformation.segmentation",type:"user"===x?"detail":"dimension",valueGetter:"data.crmInformation.segmentation",hide:"user"===x},{field:"totalBalance",colId:"totalBalance",valueFormatter:V,type:"fact",cellClassRules:{"rag-red":function(e){return e.value<=0},"rag-green":function(e){return e.value>0}}},{field:"totalContactsYtd",valueGetter:"data.crmInformation.totalContactsYtd",colId:"crmInformation.totalContactsYtd",type:"fact",aggFunc:"avg",hide:"user"===x}],I=Object.assign(z,{columnDefs:w});Object(o.useEffect)((function(){c&&G(c,g)}),[g]);var C,G=function(e,n){s(e),e.api.sizeColumnsToFit();var r=function(e){var t=e.client,n=e.searchText,r=void 0===n?"":n;return{getRows:function(e){console.log(e,r);var n=e.request,a=n.startRow,c=n.endRow,o=n.rowGroupCols,s=n.groupKeys,i=n.valueCols,u=n.sortModel;u.map((function(e){return e.sort=e.sort.toUpperCase()}));var l={query:Object(Y.a)(P||(P=Object(k.a)(["\n                    query getGridData($queryModelInput:GridQueryModel) {\n                        getGridData(input: $queryModelInput) {\n                            lastRow\n                            query\n                            rows {\n                                customerId\n                                lastName\n                                firstName\n                                age\n                                totalBalance\n                                address {\n                                    country\n                                }\n                                crmInformation {\n                                    segmentation\n                                    totalContactsYtd\n                                }\n                                accounts {\n                                    balance\n                                    name\n                                    number\n                                    type\n                                }\n                            }\n                        }\n                    }\n                "]))),variables:{queryModelInput:{startRow:a,endRow:c,rowGroupCols:o,groupKeys:s,valueCols:i,sortModel:u,searchText:r}}};t.query(l).then((function(e){return e.data.getGridData})).then((function(t){var n=t.lastRow,r=t.rows;e.successCallback(r,n)})).catch((function(t){console.error(t),e.failCallback()}))}}}({client:t,searchText:n});e.api.setServerSideDatasource(r)};return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)($,{}),"user"!==v.customData.role&&Object(j.jsx)(S.a,{type:"search",placeholder:"Search for customer...",onChange:function(e){return y(e.target.value)}}),Object(j.jsx)("div",{style:{height:"calc(100vh - 280px)"},className:"ag-theme-alpine",children:Object(j.jsx)(N.AgGridReact,{gridOptions:I,onGridReady:G,onModelUpdated:function(e){d(e.api.getDisplayedRowCount())},masterDetail:!0,detailCellRendererParams:{getDetailRowData:function(e){console.log(e.data),e.successCallback(e.data.accounts)},detailGridOptions:{columnDefs:[{field:"number"},{field:"name",sortable:!0},{field:"type",sortable:!0},{field:"balance",cellClassRules:{"rag-red":function(e){return e.value<=0},"rag-green":function(e){return e.value>0}},sortable:!0}]}}})}),Object(j.jsxs)("div",{style:{margin:10},children:[Object(j.jsx)("p",{children:"Total Results: ".concat((C=l,new Intl.NumberFormat("de-DE").format(C)))}),Object(j.jsxs)("p",{children:["User: ",v.id?"".concat(v.profile.email," (").concat(v.providerType,")"):"not logged in"]}),Object(j.jsx)("p",{children:"Role: ".concat(x)}),Object(j.jsx)(R.a,{variant:"primary",onClick:function(){return n.logOut()},children:"Logout"})]})]})})),X=n(126),Z={auth:{clientId:"ce0096fb-ed00-4e8f-bc85-0ddffffadf6e",authority:"https://login.microsoftonline.com/".concat("6fbb76cd-297f-4298-a09f-bf1180c8f291"),redirectUri:"https://mybankgridview-ahggo.mongodbstitch.com",postLogoutRedirectUri:"https://mybankgridview-ahggo.mongodbstitch.com",mainWindowRedirectUri:"https://mybankgridview-ahggo.mongodbstitch.com"},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},system:{loggerOptions:{loggerCallback:function(e,t,n){if(!n)switch(e){case X.a.Error:return void console.error(t);case X.a.Info:return void console.info(t);case X.a.Verbose:return void console.debug(t);case X.a.Warning:return void console.warn(t)}}}}},ee=n(488),te=n(490),ne=n(487),re=n(485),ae=function(e){var t=new ee.a({uri:"https://eu-central-1.aws.realm.mongodb.com/api/client/v2.0/app/".concat(e.id,"/graphql"),fetch:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var t=Object(p.a)(d.a.mark((function t(n,r){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.currentUser){t.next=2;break}throw new Error("Must be logged in to use the GraphQL API");case 2:return t.next=4,e.currentUser.refreshCustomData();case 4:return r.headers.Authorization="Bearer ".concat(e.currentUser.accessToken),t.abrupt("return",fetch(n,r));case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}),n=new te.a;return new ne.a({link:t,cache:n})},ce=function(e){var t=e.children,n=m(),r=s.a.useState(ae(n)),a=Object(b.a)(r,2),c=a[0],o=a[1];return s.a.useEffect((function(){o(ae(n))}),[n]),Object(j.jsx)(re.a,{client:c,children:t})},oe=new x.a(Z),se=function(e){var t=e.children;return m().currentUser?t:Object(j.jsx)(T,{})},ie=function(){return Object(j.jsx)(O,{appId:"mybankgridview-ahggo",children:Object(j.jsx)(v.a,{instance:oe,children:Object(j.jsx)(y.a,{children:Object(j.jsxs)(w.c,{children:[Object(j.jsx)(w.a,{path:"/google_login",element:Object(j.jsx)(A,{})}),Object(j.jsx)(w.a,{path:"/",element:Object(j.jsx)(se,{children:Object(j.jsx)(ce,{children:Object(j.jsx)(H,{})})})})]})})})})};u.a.render(Object(j.jsx)(s.a.StrictMode,{children:Object(j.jsx)(ie,{})}),document.getElementById("root"))}},[[475,1,2]]]);
//# sourceMappingURL=main.b70f8bc1.chunk.js.map