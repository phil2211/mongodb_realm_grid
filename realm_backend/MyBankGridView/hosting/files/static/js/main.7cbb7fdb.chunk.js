(this.webpackJsonpmongodb_realm_grid=this.webpackJsonpmongodb_realm_grid||[]).push([[0],{264:function(e,t,n){},270:function(e,t){},272:function(e,t){},281:function(e,t){},283:function(e,t){},310:function(e,t){},311:function(e,t){},316:function(e,t){},318:function(e,t){},325:function(e,t){},344:function(e,t){},474:function(e,t,n){"use strict";n.r(t);var r,a,c,o=n(1),s=n.n(o),u=n(102),i=n.n(u),l=(n(264),n(9)),d=n.n(l),f=n(22),p=n(19),b=n(17),g=n(60),j=n(13),h=s.a.createContext(),m=function(){var e=s.a.useContext(h);if(!e)throw new Error("You must call useRealmApp() inside of a <RealmAppProvider />");return e},v=function(e){var t=e.appId,n=e.children,r=s.a.useState(new g.a(t)),a=Object(b.a)(r,2),c=a[0],o=a[1];s.a.useEffect((function(){o(new g.a(t))}),[t]);var u=s.a.useState(c.currentUser),i=Object(b.a)(u,2),l=i[0],m=i[1];function v(){return(v=Object(p.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=g.b.jwt(t),e.next=3,c.logIn(n);case 3:m(c.currentUser);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return(O=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.logIn(g.b.google("".concat("https://mybankgridview-ahggo.mongodbstitch.com","/google_login")));case 2:m(c.currentUser);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){return(x=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.logIn(t);case 2:m(c.currentUser);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return(w=Object(p.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=c.currentUser)||void 0===t?void 0:t.logOut();case 2:m(c.currentUser);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=Object(f.a)(Object(f.a)({},c),{},{currentUser:l,logIn:function(e){return x.apply(this,arguments)},logInJwt:function(e){return v.apply(this,arguments)},logInGoogle:function(){return O.apply(this,arguments)},logOut:function(){return w.apply(this,arguments)}});return Object(j.jsx)(h.Provider,{value:y,children:n})},O=n(132),x=n(485),w=n(256),y=n(23),k=n(73),I=n(244),S=n(111),C=n(110),G=n(131),R=n(5),U=n(165),D=S.a.div(r||(r=Object(k.a)(["\n  height: 100vh;\n  justify-content: center;\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n  background: ",";\n"])),R.a.gray.light2),E=n(253),M=n.n(E);function T(){return Object(j.jsx)(M.a,{size:"15px",margin:"3px",color:R.a.gray.dark2})}var F=function(){var e=m(),t=s.a.useState(""),n=Object(b.a)(t,2),r=n[0],a=n[1],c=s.a.useState(""),o=Object(b.a)(c,2),u=o[0],i=o[1],l=s.a.useState({}),h=Object(b.a)(l,2),v=h[0],x=h[1],w=s.a.useState(!1),y=Object(b.a)(w,2),k=y[0],S=y[1],R=Object(O.b)(),E=R.instance,M=R.accounts,F=function(){var t=Object(p.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return S(!0),x((function(e){return Object(f.a)(Object(f.a)({},e),{},{password:null})})),t.prev=2,t.next=5,e.logIn(g.b.emailPassword(r,u));case 5:t.next=11;break;case 7:t.prev=7,t.t0=t.catch(2),L(t.t0,x),S(!1);case 11:case"end":return t.stop()}}),t,null,[[2,7]])})));return function(){return t.apply(this,arguments)}}(),q=function(){var t=Object(p.a)(d.a.mark((function t(){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,E.acquireTokenPopup({scopes:["".concat("ce0096fb-ed00-4e8f-bc85-0ddffffadf6e","/.default")],account:M[0]});case 3:return n=t.sent,t.next=6,JSON.stringify(n.accessToken).slice(1,-1);case 6:return n=t.sent,t.next=9,e.logInJwt(n);case 9:t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0),L(t.t0,x);case 15:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(){return t.apply(this,arguments)}}(),N=function(){var t=Object(p.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.logInGoogle();case 3:t.next=9;break;case 5:t.prev=5,t.t0=t.catch(0),console.log(t.t0),L(t.t0,x);case 9:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(){return t.apply(this,arguments)}}(),L=function(e,t){var n=function(e){var t,n=e.message.split(":"),r=n[n.length-1].trimStart();if(!r)return{status:"",message:""};var a=Object(I.a)(/(.+)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]\(status ([0-9][0-9][0-9])/,{message:1,status:2}),c=r.match(a),o=null!==(t=null===c||void 0===c?void 0:c.groups)&&void 0!==t?t:{},s=o.status,u=o.message;return{status:s,message:u}}(e),r=n.status,a=n.message||r;switch(console.log(a),a){case"invalid username":t((function(e){return Object(f.a)(Object(f.a)({},e),{},{email:"Invalid email address"})}));break;case"invalid username/password":case"invalid password":case"401":t((function(e){return Object(f.a)(Object(f.a)({},e),{},{password:"Incorrect password"})}))}};return Object(j.jsx)(D,{children:k?Object(j.jsx)(T,{}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(A,{children:Object(j.jsx)(P,{children:"Please identify"})}),Object(j.jsx)(A,{children:Object(j.jsx)(C.a,{type:"email",label:"Email",value:r,onChange:function(e){return a(e.target.value)},errorMessage:v.email,state:v.email?"error":"none"})}),Object(j.jsx)(A,{children:Object(j.jsx)(C.a,{type:"password",label:"Password",value:u,onChange:function(e){return i(e.target.value)},errorMessage:v.password,state:v.password?"error":"none"})}),Object(j.jsx)(A,{children:Object(j.jsx)(G.a,{variant:"primary",onClick:function(){return F()},children:"Login"})}),Object(j.jsx)(A,{children:Object(j.jsx)(U.MicrosoftLoginButton,{onClick:function(){return q()}})}),Object(j.jsx)(A,{children:Object(j.jsx)(U.GoogleLoginButton,{onClick:function(){return N()}})})]})})};var q,P=S.a.h1(a||(a=Object(k.a)(["\n  margin: 0;\n  font-size: 32px;\n"]))),A=S.a.div(c||(c=Object(k.a)(["\n  margin-bottom: 16px;\n"]))),N=function(){return Object(o.useEffect)((function(){Object(g.c)()})),Object(j.jsx)("h1",{children:"Signing in... Please Wait"})},L=n(254),z=n(92),B=(n(471),n(472),n(473),{columnTypes:{detail:{enableRowGroup:!1,enablePivot:!1},dimension:{enableRowGroup:!0,enablePivot:!0},valueColumn:{aggFunc:"sum"}},defaultColDef:{sortable:!0,resizable:!0},rowSelection:"single",rowModelType:"serverSide",serverSideStoreType:"partial",cacheBlockSize:50,rowGroupPanelShow:"always",groupDisplayType:"multipleColumns",onSortChanged:function(e){e.api.refreshServerSideStore({purge:!0})},maxConcurrentDatasourceRequests:5,rowBuffer:100}),_=n(477),J=function(e){return function(t){return Object(j.jsx)(_.a,{children:function(n){return Object(j.jsx)(e,Object(f.a)({client:n},t))}})}},W=n(488),K=function(e){return new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(e.value)},Q=J((function(e){var t=e.client,n=m(),r=Object(o.useState)(null),a=Object(b.a)(r,2),c=a[0],s=a[1],u=Object(o.useState)(0),i=Object(b.a)(u,2),l=i[0],d=i[1],f=Object(o.useState)(""),p=Object(b.a)(f,2),g=p[0],h=p[1],v=Object(o.useState)(n.currentUser),O=Object(b.a)(v,1)[0],x=O.customData.role,w=Object(z.debounce)(h,500),y=[{field:"customer",colId:"customerId",valueGetter:"data.customerId",type:"dimension",rowGroup:!0,hide:!0},{field:"lastName",type:"detail"},{field:"firstName",type:"detail"},{field:"age",type:"user"===x?"detail":"dimension"},{field:"country",colId:"address.country",type:"user"===x?"detail":"dimension",valueGetter:"data.address.country"},{field:"segment",colId:"crmInformation.segmentation",type:"user"===x?"detail":"dimension",valueGetter:"data.crmInformation.segmentation",hide:"user"===x},{field:"account",colId:"accounts.number",valueGetter:"data.accounts.number"},{field:"balance",colId:"accounts.balance",valueGetter:"data.accounts.balance",valueFormatter:K,type:"valueColumn",cellClassRules:{"rag-red":function(e){return e.value<=0},"rag-green":function(e){return e.value>0}}}],I=Object.assign(B,{columnDefs:y});Object(o.useEffect)((function(){c&&R(c,g)}),[g]);var S,R=function(e,n){s(e),e.api.sizeColumnsToFit();var r=function(e){var t=e.client,n=e.searchText,r=void 0===n?"":n;return{getRows:function(e){console.log(e,r);var n=e.request,a=n.startRow,c=n.endRow,o=n.rowGroupCols,s=n.groupKeys,u=n.valueCols,i=n.sortModel;i.map((function(e){return e.sort=e.sort.toUpperCase()}));var l={query:Object(W.a)(q||(q=Object(k.a)(["\n                    query getGridData($queryModelInput:GridQueryModel) {\n                        getGridData(input: $queryModelInput) {\n                            lastRow\n                            query\n                            rows {\n                                ","\n                            }\n                        }\n                    }\n                }\n                "])),o.length>0&&o.length===s.length?"\n            accounts {\n                number\n                balance\n            ":"\n            customerId\n            lastName\n            firstName\n            age\n            address {\n                country\n            }\n            crmInformation {\n                segmentation\n            }\n            accounts {\n                number\n                balance\n            "),variables:{queryModelInput:{startRow:a,endRow:c,rowGroupCols:o,groupKeys:s,valueCols:u,sortModel:i,searchText:r}}};t.query(l).then((function(e){return e.data.getGridData})).then((function(t){var n=t.lastRow,r=t.rows;e.successCallback(r,n)})).catch((function(t){console.error(t),e.failCallback()}))}}}({client:t,searchText:n});e.api.setServerSideDatasource(r)};return console.log(O),Object(j.jsxs)(j.Fragment,{children:["user"!==O.customData.role&&Object(j.jsx)(C.a,{type:"search",placeholder:"Search for customer...",onChange:function(e){return w(e.target.value)}}),Object(j.jsx)("div",{style:{height:"calc(100vh - 250px)"},className:"ag-theme-alpine",children:Object(j.jsx)(L.AgGridReact,{gridOptions:I,onGridReady:R,onModelUpdated:function(e){d(e.api.getDisplayedRowCount())}})}),Object(j.jsxs)("div",{style:{margin:10},children:[Object(j.jsx)("p",{children:"Total Results: ".concat((S=l,new Intl.NumberFormat("de-DE").format(S)))}),Object(j.jsxs)("p",{children:["User: ",O.id?"".concat(O.profile.name," (").concat(O.providerType,")"):"not logged in"]}),Object(j.jsx)("p",{children:"Role: ".concat(x)}),Object(j.jsx)(G.a,{variant:"primary",onClick:function(){return n.logOut()},children:"Logout"})]})]})})),$=n(126),V={auth:{clientId:"ce0096fb-ed00-4e8f-bc85-0ddffffadf6e",authority:"https://login.microsoftonline.com/".concat("6fbb76cd-297f-4298-a09f-bf1180c8f291"),redirectUri:"https://mybankgridview-ahggo.mongodbstitch.com",postLogoutRedirectUri:"https://mybankgridview-ahggo.mongodbstitch.com",mainWindowRedirectUri:"https://mybankgridview-ahggo.mongodbstitch.com"},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},system:{loggerOptions:{loggerCallback:function(e,t,n){if(!n)switch(e){case $.a.Error:return void console.error(t);case $.a.Info:return void console.info(t);case $.a.Verbose:return void console.debug(t);case $.a.Warning:return void console.warn(t)}}}}},Y=n(487),H=n(489),X=n(486),Z=n(484),ee=function(e){var t=new Y.a({uri:"https://eu-central-1.aws.realm.mongodb.com/api/client/v2.0/app/".concat(e.id,"/graphql"),fetch:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var t=Object(p.a)(d.a.mark((function t(n,r){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.currentUser){t.next=2;break}throw new Error("Must be logged in to use the GraphQL API");case 2:return t.next=4,e.currentUser.refreshCustomData();case 4:return r.headers.Authorization="Bearer ".concat(e.currentUser.accessToken),t.abrupt("return",fetch(n,r));case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}),n=new H.a;return new X.a({link:t,cache:n})},te=function(e){var t=e.children,n=m(),r=s.a.useState(ee(n)),a=Object(b.a)(r,2),c=a[0],o=a[1];return s.a.useEffect((function(){o(ee(n))}),[n]),Object(j.jsx)(Z.a,{client:c,children:t})},ne=new x.a(V),re=function(e){var t=e.children;return m().currentUser?t:Object(j.jsx)(F,{})},ae=function(){return Object(j.jsx)(v,{appId:"mybankgridview-ahggo",children:Object(j.jsx)(O.a,{instance:ne,children:Object(j.jsx)(w.a,{children:Object(j.jsxs)(y.c,{children:[Object(j.jsx)(y.a,{path:"/google_login",element:Object(j.jsx)(N,{})}),Object(j.jsx)(y.a,{path:"/",element:Object(j.jsx)(re,{children:Object(j.jsx)(te,{children:Object(j.jsx)(Q,{})})})})]})})})})};i.a.render(Object(j.jsx)(s.a.StrictMode,{children:Object(j.jsx)(ae,{})}),document.getElementById("root"))}},[[474,1,2]]]);
//# sourceMappingURL=main.7cbb7fdb.chunk.js.map