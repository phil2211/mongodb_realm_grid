{"version":3,"sources":["RealmApp.js","Components/Container.js","Components/Loading.js","Containers/LoginScreen.js","Containers/GoogleLogin.js","Containers/GridOptions.js","lib/graphql/ApolloClientWrapper.js","Components/Header.js","Containers/Grid.js","lib/graphql/gridDatasource.js","lib/azure/authConfig.js","lib/graphql/apolloClient.js","App.js","index.js"],"names":["RealmAppContext","React","createContext","useRealmApp","app","useContext","Error","RealmAppProvider","appId","children","useState","Realm","setApp","useEffect","currentUser","setCurrentUser","credentials","a","jwt","logIn","google","process","logOut","wrapped","logInJwt","logInGoogle","Provider","value","Container","styled","div","uiColors","gray","light2","Loading","size","margin","color","dark2","LoginScreen","email","setEmail","password","setPassword","error","setError","isLoggingIn","setIsLoggingIn","useMsal","instance","accounts","handleLogin","e","emailPassword","handleAuthenticationError","handleSSOLogin","acquireTokenPopup","scopes","account","JSON","stringify","accessToken","slice","console","log","handleSSOGoogleLogin","err","parts","message","split","reason","length","trimStart","status","reasonRegex","match","groups","parseAuthenticationError","errorType","prevErr","LoginFormRow","LoginHeading","type","label","onChange","target","errorMessage","state","variant","onClick","h1","GoogleLogin","handleAuthRedirect","columnTypes","detail","enableRowGroup","enablePivot","dimension","fact","aggFunc","defaultColDef","sortable","resizable","rowSelection","rowModelType","serverSideStoreType","cacheBlockSize","rowGroupPanelShow","groupDisplayType","onSortChanged","params","api","refreshServerSideStore","purge","maxConcurrentDatasourceRequests","rowBuffer","clientProvider","WrappedComponent","props","ApolloConsumer","client","Header","style","marginRight","formatCurrency","Intl","NumberFormat","currency","format","ApolloClientWrapper","gridApi","setGridApi","totalRows","setTotalRows","searchText","setSearchText","user","role","customData","debouncedSearch","debounce","columnDefs","field","colId","valueGetter","cellRenderer","hide","valueFormatter","cellClassRules","gridOptions","Object","assign","GridOptions","onGridReady","sizeColumnsToFit","datasource","getRows","request","startRow","endRow","rowGroupCols","groupKeys","valueCols","sortModel","map","model","sort","toUpperCase","query","gql","variables","then","res","data","getGridData","lastRow","rows","successCallback","catch","failCallback","createServerSideDatasource","setServerSideDatasource","placeholder","event","height","className","onModelUpdated","getDisplayedRowCount","masterDetail","detailCellRendererParams","getDetailRowData","detailGridOptions","id","profile","name","providerType","msalConfig","auth","clientId","authority","redirectUri","postLogoutRedirectUri","mainWindowRedirectUri","cache","cacheLocation","storeAuthStateInCookie","system","loggerOptions","loggerCallback","level","containsPii","LogLevel","Info","info","Verbose","debug","Warning","warn","createRealmApolloClient","link","HttpLink","uri","fetch","options","refreshCustomData","headers","Authorization","InMemoryCache","ApolloClient","RealmApolloProvider","setClient","ApolloProvider","msalInstance","PublicClientApplication","RequireLoggedInUser","App","path","element","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.51286e3d.chunk.js","sourcesContent":["import React from \"react\";\nimport * as Realm from \"realm-web\";\n\nconst RealmAppContext = React.createContext();\n\nexport const useRealmApp = () => {\n    const app = React.useContext(RealmAppContext);\n    if (!app) {\n        throw new Error (\n            `You must call useRealmApp() inside of a <RealmAppProvider />`\n        );\n    }\n    return app;\n}\n\nexport const RealmAppProvider = ({ appId, children }) => {\n    const [app, setApp] = React.useState(new Realm.App(appId));\n    React.useEffect(() => {\n        setApp(new Realm.App(appId));\n    }, [appId]);\n\n    // Wrap the Realm.App object's user state with React state\n    const [currentUser, setCurrentUser] = React.useState(app.currentUser);\n\n    async function logInJwt(credentials) {\n        const jwt = Realm.Credentials.jwt(credentials);\n        await app.logIn(jwt);\n        // If successful, app.currentUser is the user that just logged in\n        setCurrentUser(app.currentUser);\n    }\n\n    async function logInGoogle() {\n        await app.logIn(Realm.Credentials.google(`${process.env.REACT_APP_REDIRECT}/google_login`));\n        setCurrentUser(app.currentUser);\n    }\n\n    async function logIn(credentials) {\n        await app.logIn(credentials);\n        // If successful, app.currentUser is the user that just logged in\n        setCurrentUser(app.currentUser);\n    }\n\n    async function logOut() {\n        // Log out the currrently active user\n        await app.currentUser?.logOut();\n        // If another user was logged in too, they're now the current user.\n        // Otherwise, app.currentUser is null.\n        setCurrentUser(app.currentUser);\n    }\n\n    const wrapped = { ...app, currentUser, logIn, logInJwt, logInGoogle, logOut };\n\n    return (\n        <RealmAppContext.Provider value={wrapped}>\n            {children}\n        </RealmAppContext.Provider>\n    );\n};","import styled from \"@emotion/styled\";\nimport { uiColors } from \"@leafygreen-ui/palette\";\n\nconst Container = styled.div`\n  height: 100vh;\n  justify-content: center;\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n  background: ${uiColors.gray.light2};\n`;\n\nexport default Container;","import React from \"react\";\nimport { uiColors } from \"@leafygreen-ui/palette\";\nimport GridLoader from \"react-spinners/GridLoader\";\n\nexport default function Loading() {\n  return <GridLoader size=\"15px\" margin=\"3px\" color={uiColors.gray.dark2} />;\n}\n","import React from \"react\";\nimport * as Realm from \"realm-web\";\nimport styled from \"@emotion/styled\";\nimport TextInput from \"@leafygreen-ui/text-input\";\nimport Button from \"@leafygreen-ui/button\";\nimport { uiColors } from \"@leafygreen-ui/palette\";\nimport { useMsal } from \"@azure/msal-react\";\nimport { GoogleLoginButton, MicrosoftLoginButton } from \"react-social-login-buttons\";\n\nimport { useRealmApp } from \"../RealmApp\";\nimport Container from \"../Components/Container\";\nimport Loading from \"../Components/Loading\";\n\n\n\nconst LoginScreen = () => {\n    const app = useRealmApp();\n    const [email, setEmail] = React.useState(\"\");\n    const [password, setPassword] = React.useState(\"\");\n    const [error, setError] = React.useState({});\n    const [isLoggingIn, setIsLoggingIn] = React.useState(false);\n    const { instance, accounts } = useMsal();\n\n    const handleLogin = async () => {\n        setIsLoggingIn(true);\n        setError((e) => ({ ...e, password: null }));\n        try {\n            await app.logIn(Realm.Credentials.emailPassword(email, password));\n        } catch (err) {\n            handleAuthenticationError(err, setError)\n            setIsLoggingIn(false);\n        }\n    }\n    \n    const handleSSOLogin = async () => {\n        try {\n            //setIsLoggingIn(true);\n\n            let jwt = await instance.acquireTokenPopup({\n                scopes: [`${process.env.REACT_APP_APPID}/.default`],\n                account: accounts[0]\n            });\n    \n            jwt = await JSON.stringify(jwt.accessToken).slice(1,-1);\n            await app.logInJwt(jwt);\n        } catch (err) {\n            console.log(err);\n            handleAuthenticationError(err, setError);\n        }\n    }\n\n    const handleSSOGoogleLogin = async () => {\n        try {\n            await app.logInGoogle();\n        } catch (err) {\n            console.log(err);\n            handleAuthenticationError(err, setError);\n        }\n    }\n\n    const handleAuthenticationError = (err, setError) => {\n        const { status, message } = parseAuthenticationError(err);\n        const errorType = message || status;\n        console.log(errorType);\n        switch (errorType) {\n            case \"invalid username\":\n                setError((prevErr) => ({ ...prevErr, email: \"Invalid email address\"}));\n                break;\n            case \"invalid username/password\":\n            case \"invalid password\":\n            case \"401\":\n                setError((err) => ({ ...err, password: \"Incorrect password\"}));\n                break;\n            default:\n                break;\n        }\n    }\n\n    return (\n        <Container>\n            {isLoggingIn ? (\n                <Loading />\n            ) : (\n                <>\n                <LoginFormRow>\n                    <LoginHeading>Please identify</LoginHeading>\n                </LoginFormRow>\n                <LoginFormRow>\n                    <TextInput \n                        type=\"email\" \n                        label=\"Email\"\n                        value={email}\n                        onChange={(e) => setEmail(e.target.value)}\n                        errorMessage={error.email}\n                        state={error.email ? \"error\" : \"none\"}\n                    />\n                </LoginFormRow>\n                <LoginFormRow>\n                    <TextInput \n                        type=\"password\" \n                        label=\"Password\"\n                        value={password}\n                        onChange={(e) => setPassword(e.target.value)}\n                        errorMessage={error.password}\n                        state={error.password ? \"error\" : \"none\" }\n                    />\n                </LoginFormRow> \n                <LoginFormRow>\n                    <Button variant=\"primary\" onClick={() => handleLogin()}>Login</Button>\n                </LoginFormRow>           \n                <LoginFormRow>\n                    <MicrosoftLoginButton onClick={() => handleSSOLogin()} />\n                </LoginFormRow>\n                <LoginFormRow>\n                    <GoogleLoginButton onClick={() => handleSSOGoogleLogin()} />\n                </LoginFormRow>\n                </>\n            )}\n        </Container>\n    )\n}\n\nexport default LoginScreen;\n\nfunction parseAuthenticationError(err) {\n    const parts = err.message.split(\":\");\n    const reason = parts[parts.length - 1].trimStart();\n    if (!reason) return { status: \"\", message: \"\" };\n    const reasonRegex = /(?<message>.+)\\s\\(status (?<status>[0-9][0-9][0-9])/;\n    const match = reason.match(reasonRegex);\n    const { status, message } = match?.groups ?? {};\n    return { status, message };\n}\n\nconst LoginHeading = styled.h1`\n  margin: 0;\n  font-size: 32px;\n`;\n\nconst LoginFormRow = styled.div`\n  margin-bottom: 16px;\n`;","import React, { useEffect } from \"react\";\nimport { handleAuthRedirect } from \"realm-web\";\n\nconst GoogleLogin = () => {\n    useEffect(() => {\n        handleAuthRedirect();\n    })\n    return (\n        <h1>Signing in... Please Wait</h1>\n    )\n}\n\nexport default GoogleLogin;","const columnTypes = {\n    detail: {\n        enableRowGroup: false,\n        enablePivot: false\n    },\n    dimension: {\n        enableRowGroup: true,\n        enablePivot: true\n    },\n    fact: {\n        aggFunc: \"sum\",\n    }\n};\n\nconst sideBar = {\n    toolPanels: [\n        {\n            id: \"columns\",\n            labelDefault: \"Columns\",\n            toolPanel: \"agColumnsToolPanel\"\n        }\n    ]\n}\n\nconst rowGroupPanelShow = \"always\";\n\nconst groupDisplayType = \"multipleColumns\";\n\nconst defaultColDef = {\n    sortable: true,\n    resizable: true\n}\n\nconst onSortChanged = (params) => {\n    params.api.refreshServerSideStore({purge: true});\n}\n\nconst rowSelection = \"single\";\nconst rowModelType = \"serverSide\";\nconst serverSideStoreType = \"partial\";\nconst cacheBlockSize = 50;\nconst maxConcurrentDatasourceRequests = 5;\nconst rowBuffer = 100;\n\n\nexport default {\n    columnTypes,\n    defaultColDef,\n    rowSelection,\n    rowModelType,\n    serverSideStoreType,\n    cacheBlockSize,\n    rowGroupPanelShow,\n    groupDisplayType,\n    onSortChanged,\n    maxConcurrentDatasourceRequests,\n    rowBuffer\n    //sideBar\n}","import { ApolloConsumer } from \"@apollo/client\";\n\nconst clientProvider = WrappedComponent => {\n    return props => (\n      <ApolloConsumer>\n        {client => {\n          return <WrappedComponent client={client} {...props} />\n        }}\n      </ApolloConsumer>\n    )\n  }\n  \nexport default clientProvider;","import { RealmLogoLockup, AtlasLogoLockup, RealmLogoMark } from '@leafygreen-ui/logo';\nimport * as React from 'react';\n\nconst Header = () => {\n    return (\n        <div style={{margin: 20}}>\n            <AtlasLogoLockup />\n            <span style={{marginRight: 20}} />\n            <RealmLogoLockup />\n        </div>\n        \n    );\n};\n\nexport default Header;","import React, { useState, useEffect } from \"react\";\nimport { AgGridReact } from \"ag-grid-react\";\nimport { debounce } from \"lodash\";\nimport Button from \"@leafygreen-ui/button\";\nimport TextInput from '@leafygreen-ui/text-input';\nimport \"ag-grid-community/dist/styles/ag-grid.css\";\nimport \"ag-grid-community/dist/styles/ag-theme-alpine.css\";\nimport \"ag-grid-enterprise\";\n\nimport GridOptions from './GridOptions';\nimport ApolloClientWrapper from '../lib/graphql/ApolloClientWrapper';\nimport { createServerSideDatasource } from \"../lib/graphql/gridDatasource\";\nimport { useRealmApp } from \"../RealmApp\";\nimport Header from \"../Components/Header\";\n\nconst formatCurrency = (params) => {\n    return new Intl.NumberFormat('de-DE', {style: 'currency', currency: 'EUR'}).format(params.value);\n}\n\nconst formatNumber = (value) => {\n    return new Intl.NumberFormat('de-DE').format(value);\n}\n\n\nconst Grid = ({ client }) => {\n    const app = useRealmApp();\n    const [gridApi, setGridApi] = useState(null);\n    const [totalRows, setTotalRows] = useState(0);\n    const [searchText, setSearchText] = useState('');\n    const [user] = useState(app.currentUser);\n    const { role } = user.customData;\n\n    const debouncedSearch = debounce(setSearchText, 500);\n\n    const columnDefs = [\n        { \n            field: \"customer\",\n            colId: \"customerId\",\n            valueGetter: \"data.customerId\",\n            type: \"detail\",\n            cellRenderer: \"agGroupCellRenderer\"\n        },\n        { field: \"lastName\", type: \"detail\" },\n        { field: \"firstName\", type: \"detail\" },\n        { field: \"age\", type: role===\"user\"?\"detail\":\"dimension\" },\n        { field: \"country\", colId: \"address.country\", type: role===\"user\"?\"detail\":\"dimension\", valueGetter: \"data.address.country\"},\n        { field: \"segment\", colId: \"crmInformation.segmentation\", type: role===\"user\"?\"detail\":\"dimension\", valueGetter: \"data.crmInformation.segmentation\", hide: role === \"user\" },\n        { \n            field: \"totalBalance\", \n            colId: \"totalBalance\",\n            valueFormatter: formatCurrency,\n            type: \"fact\",\n            cellClassRules: {\n                \"rag-red\": params => params.value <= 0,\n                \"rag-green\": params => params.value > 0\n            }\n        },\n        { \n            field: \"totalContactsYtd\",\n            valueGetter: \"data.crmInformation.totalContactsYtd\",\n            colId: \"crmInformation.totalContactsYtd\",\n            type: \"fact\",\n            aggFunc: \"avg\"\n        }\n\n    ]\n    const gridOptions = Object.assign(GridOptions, { columnDefs });\n\n    const detailColumnDefs = [\n        {field: \"number\"},\n        {field: \"name\", sortable: true},\n        {field: \"type\", sortable: true},\n        {field: \"balance\", cellClassRules: {\n                \"rag-red\": params => params.value <= 0,\n                \"rag-green\": params => params.value > 0\n            }, \n            sortable: true\n        }\n    ]\n\n    useEffect(() => {\n        if(gridApi) {\n            onGridReady(gridApi, searchText);\n        }\n    }, [searchText]);\n\n    const onGridReady = (params, searchText) => {\n        setGridApi(params);\n        params.api.sizeColumnsToFit();\n        const datasource = createServerSideDatasource({ client, searchText });\n        params.api.setServerSideDatasource(datasource);\n    }\n\n    const onModelUpdate = (params) => {\n        setTotalRows(params.api.getDisplayedRowCount());\n    }\n\n    return (\n        <>   \n        <Header />    \n        {user.customData.role !== \"user\" &&\n            <TextInput\n                type=\"search\"\n                placeholder=\"Search for customer...\"\n                onChange={event => debouncedSearch(event.target.value)}\n            />}\n        <div         \n            style={{ height: \"calc(100vh - 280px)\" }}\n            className=\"ag-theme-alpine\"\n        >\n            <AgGridReact\n                gridOptions={gridOptions}\n                onGridReady={onGridReady}\n                onModelUpdated={onModelUpdate}\n                masterDetail={true}\n                detailCellRendererParams={{\n                    getDetailRowData: (params) => {\n                        console.log(params.data)\n                        params.successCallback(params.data.accounts)\n                    },\n                    detailGridOptions: {\n                        columnDefs: detailColumnDefs\n                    }\n                }}\n            />\n        </div>\n        <div style={{margin: 10}}>\n            <p>{`Total Results: ${formatNumber(totalRows)}`}</p>\n            <p>User: {user.id ? `${user.profile.name} (${user.providerType})` : \"not logged in\"}</p>\n            <p>{`Role: ${role}`}</p>\n            <Button variant=\"primary\" onClick={() => app.logOut()}>Logout</Button>\n        </div>\n        </>\n    )\n}\n\nexport default ApolloClientWrapper(Grid);","import { gql } from \"@apollo/client\";\n\nexport const createServerSideDatasource = ({ client, searchText='' }) => {\n    return {\n        getRows: (params) => {\n            console.log(params, searchText);\n            const { startRow, endRow, rowGroupCols, groupKeys, valueCols, sortModel } = params.request;\n            sortModel.map(model => model.sort = model.sort.toUpperCase());\n\n            const query = { \n                query: gql`\n                    query getGridData($queryModelInput:GridQueryModel) {\n                        getGridData(input: $queryModelInput) {\n                            lastRow\n                            query\n                            rows {\n                                customerId\n                                lastName\n                                firstName\n                                age\n                                totalBalance\n                                address {\n                                    country\n                                }\n                                crmInformation {\n                                    segmentation\n                                    totalContactsYtd\n                                }\n                                accounts {\n                                    balance\n                                    name\n                                    number\n                                    type\n                                }\n                            }\n                        }\n                    }\n                `,\n                variables: {\n                    \"queryModelInput\" : {\n                        startRow,\n                        endRow,\n                        rowGroupCols,\n                        groupKeys,\n                        valueCols,\n                        sortModel,\n                        searchText\n                    }\n                }\n            };\n\n            client.query(query)\n            .then(res => res.data.getGridData)\n            .then(({ lastRow, rows }) => {\n                params.successCallback(rows, lastRow)\n            })\n            .catch(err => {\n                console.error(err);\n                params.failCallback();\n            })\n        }\n    }\n}","/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\nimport { LogLevel } from \"@azure/msal-browser\";\n\n/**\n * Configuration object to be passed to MSAL instance on creation. \n * For a full list of MSAL.js configuration parameters, visit:\n * https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-browser/docs/configuration.md \n */\nexport const msalConfig = {\n    auth: {\n        clientId: process.env.REACT_APP_APPID,\n        authority: `https://login.microsoftonline.com/${process.env.REACT_APP_TENANTID}`,\n        redirectUri: process.env.REACT_APP_REDIRECT,\n        postLogoutRedirectUri: process.env.REACT_APP_REDIRECT,\n        mainWindowRedirectUri: process.env.REACT_APP_REDIRECT\n    },\n    cache: {\n        cacheLocation: \"sessionStorage\", // This configures where your cache will be stored\n        storeAuthStateInCookie: false, // Set this to \"true\" if you are having issues on IE11 or Edge\n    },\n    system: {\t\n        loggerOptions: {\t\n            loggerCallback: (level, message, containsPii) => {\t\n                if (containsPii) {\t\t\n                    return;\t\t\n                }\t\t\n                switch (level) {\t\t\n                    case LogLevel.Error:\t\t\n                        console.error(message);\t\t\n                        return;\t\t\n                    case LogLevel.Info:\t\t\n                        console.info(message);\t\t\n                        return;\t\t\n                    case LogLevel.Verbose:\t\t\n                        console.debug(message);\t\t\n                        return;\t\t\n                    case LogLevel.Warning:\t\t\n                        console.warn(message);\t\t\n                        return;\t\t\n                }\t\n            }\t\n        }\t\n    }\n};\n\n/**\n * Scopes you add here will be prompted for user consent during sign-in.\n * By default, MSAL.js will add OIDC scopes (openid, profile, email) to any login request.\n * For more information about OIDC scopes, visit: \n * https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-permissions-and-consent#openid-connect-scopes\n */\nexport const loginRequest = {\n    scopes: [\"User.Read\"]\n};\n\n/**\n * Add here the scopes to request when obtaining an access token for MS Graph API. For more information, see:\n * https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-browser/docs/resources-and-scopes.md\n */\nexport const graphConfig = {\n    graphMeEndpoint: \"https://graph.microsoft.com/v1.0/me\"\n};\n","import React from \"react\";\nimport { useRealmApp } from \"../../RealmApp\";\nimport { ApolloClient, HttpLink, InMemoryCache, ApolloProvider } from \"@apollo/client\";\n\nconst createRealmApolloClient = (app) => {\n    const link = new HttpLink({\n        uri: `https://eu-central-1.aws.realm.mongodb.com/api/client/v2.0/app/${app.id}/graphql`,\n        fetch: async (uri, options) => {\n            if (!app.currentUser) {\n                throw new Error(\"Must be logged in to use the GraphQL API\");\n            }\n            // Refreshing a user's custom data also refreshes their access token\n            await app.currentUser.refreshCustomData();\n            // The handler adds a bearer token Auth header to the otherwise unchanged request\n            options.headers.Authorization = `Bearer ${app.currentUser.accessToken}`;\n            return fetch(uri, options);\n        }\n    });\n\n    const cache = new InMemoryCache();\n\n    return new ApolloClient({ link, cache });\n}\n\nconst RealmApolloProvider = ({ children }) => {\n    const app = useRealmApp();\n    const [client, setClient] = React.useState(createRealmApolloClient(app));\n\n    React.useEffect(() => {\n        setClient(createRealmApolloClient(app));\n    }, [app]);\n    return <ApolloProvider client={client}>{children}</ApolloProvider>\n}\n\nexport default RealmApolloProvider;","import React from \"react\";\nimport { RealmAppProvider, useRealmApp } from \"./RealmApp\";\nimport { MsalProvider } from \"@azure/msal-react\";\nimport { PublicClientApplication } from \"@azure/msal-browser\";\nimport { BrowserRouter, Routes, Route } from \"react-router-dom\";\n\n\nimport LoginScreen from \"./Containers/LoginScreen\";\nimport GoogleLogin from \"./Containers/GoogleLogin\";\nimport Grid from \"./Containers/Grid\";\nimport { msalConfig } from \"./lib/azure/authConfig\";\nimport RealmApolloProvider from \"./lib/graphql/apolloClient\";\n\nconst APP_ID = process.env.REACT_APP_REALMAPP;\nconst msalInstance = new PublicClientApplication(msalConfig);\n\nconst RequireLoggedInUser = ({ children }) => {\n  // Only render children if there is a logged in user.\n  const app = useRealmApp();\n  return app.currentUser ? children : <LoginScreen />;\n};\n\nconst App = () => {\n  return (\n    <RealmAppProvider appId={APP_ID}>\n      <MsalProvider instance={msalInstance}>\n        <BrowserRouter>\n            <Routes>\n            <Route path=\"/google_login\" element={<GoogleLogin />} />\n            <Route path=\"/\" element={\n              <RequireLoggedInUser>\n                <RealmApolloProvider>\n                  <Grid />\n              </RealmApolloProvider>\n            </RequireLoggedInUser>\n            } />\n          </Routes>\n        </BrowserRouter>\n      </MsalProvider>\n    </RealmAppProvider>\n\n  )\n}\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}